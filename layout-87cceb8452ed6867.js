(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8450],{4649:(e,t,r)=>{"use strict";r.d(t,{HydrateAtomClient:()=>o});var s=r(28235),n=r(65103);function o(e){let{isFullScreen:t}=e;return(0,n.RH)([[s.LG,()=>t]]),null}},20428:(e,t,r)=>{"use strict";r.d(t,{Toaster:()=>i});var s=r(53400),n=r(59457),o=r(7824);let i=e=>{let{...t}=e,{theme:r="system"}=(0,n.D)();return(0,s.jsx)(o.l$,{theme:r,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})}},28235:(e,t,r)=>{"use strict";r.d(t,{LG:()=>c,PC:()=>b,f1:()=>h,lh:()=>g,qb:()=>u,yA:()=>d});var s=r(41401),n=r(1233),o=r(72197),i=r(63171),a=r(31074),l=r(48276);let u=(0,i.tG)("chatUseAnim",!1),d=(0,i.tG)("chatAutoScroll",!0),c=(0,i.tG)("chatFullScreen",!1),h=(0,i.tG)("chatAutoPlayBgm",!0),g=()=>{let e=(0,a.useCookies)(),[t,r]=(0,n.fp)(c);return[t,t=>{r(t),e.set(s.zs.CHAT_FULL_SCREEN,String(t),{path:"/",expires:720})}]},m=(0,o.eU)(!1),v=(0,o.eU)(new Map),b=()=>{let[e,t]=(0,n.fp)(m),[r,s]=(0,n.fp)(v),o=(0,l.useCallback)(e=>{s(t=>{let r=new Map(t);return r.set(e.id,e),r})},[s]),i=(0,l.useCallback)(e=>{s(t=>{let r=new Map(t);return r.delete(e),r})},[s]),a=(0,l.useCallback)((e,t)=>{s(r=>{let s=new Map(r);return s.has(e)?s.delete(e):s.set(e,t),s})},[s]),u=(0,l.useCallback)(()=>{s(new Map)},[s]),d=(0,l.useCallback)(()=>{t(!0)},[t]),c=(0,l.useCallback)(()=>{t(!1),u()},[t,u]);return{isSelectMode:e,setIsSelectMode:t,selected:r,toggleSelected:a,addSelected:o,removeSelected:i,clearSelected:u,openSelectMode:d,closeSelectMode:c}}},80518:(e,t,r)=>{Promise.resolve().then(r.bind(r,46211)),Promise.resolve().then(r.bind(r,6415)),Promise.resolve().then(r.bind(r,48930)),Promise.resolve().then(r.t.bind(r,98016,23)),Promise.resolve().then(r.bind(r,58700)),Promise.resolve().then(r.bind(r,83271)),Promise.resolve().then(r.bind(r,67991)),Promise.resolve().then(r.t.bind(r,63152,23)),Promise.resolve().then(r.bind(r,43083)),Promise.resolve().then(r.bind(r,41814)),Promise.resolve().then(r.bind(r,64973)),Promise.resolve().then(r.bind(r,80601)),Promise.resolve().then(r.bind(r,5293)),Promise.resolve().then(r.bind(r,63559)),Promise.resolve().then(r.bind(r,78515)),Promise.resolve().then(r.bind(r,85261)),Promise.resolve().then(r.bind(r,69062)),Promise.resolve().then(r.bind(r,30757)),Promise.resolve().then(r.bind(r,93174)),Promise.resolve().then(r.bind(r,46644)),Promise.resolve().then(r.bind(r,4649)),Promise.resolve().then(r.bind(r,85633)),Promise.resolve().then(r.bind(r,20428)),Promise.resolve().then(r.bind(r,78367)),Promise.resolve().then(r.bind(r,98759))},80601:(e,t,r)=>{"use strict";r.d(t,{RootProviders:()=>g});var s=r(53400),n=r(23785),o=r(77696),i=r(48276),a=r(41203);function l(e){let{children:t}=e,[r,n]=(0,i.useState)([]);return(0,s.jsx)(a.FB.Provider,{value:{waiters:r,createWaitingContext:e=>({isWaiting:()=>(0,a.Gu)(r,e),startWaiting:()=>n((0,a.eF)(r,e)),endWaiting:()=>n((0,a.tS)(r,e)),Wait:t=>(0,s.jsx)(a.sn,{on:e,...t})}),anyWaiting:()=>(0,a.qy)(r),isWaiting:e=>(0,a.Gu)(r,e),startWaiting(e){n((0,a.eF)(r,e))},endWaiting(e){n((0,a.tS)(r,e))}},children:t})}var u=r(38109),d=r(88926),c=r(35093),h=r(1233);function g(e){let{children:t,isDev:r=!1}=e;window.recaptchaOptions={useRecaptchaNet:!0};let[a]=i.useState(()=>new u.E({defaultOptions:{queries:{retry:!1,staleTime:6e4}}}));return(0,s.jsxs)(d.QueryClientProvider,{client:a,children:[(0,s.jsx)(h.Kq,{children:(0,s.jsx)(l,{children:(0,s.jsx)(n.tE,{children:(0,s.jsx)(o.OU,{children:t})})})}),r&&(0,s.jsx)(c.E,{buttonPosition:"bottom-right"})]})}},85633:(e,t,r)=>{"use strict";r.d(t,{UserWatcher:()=>f});var s=r(23785),n=r(61281),o=r(70712),i=r(48276);let a=e=>{let{key:t,callback:r}=e,s=e=>{if(e.key===t)try{let t=e.newValue?e.newValue:null;t!==e.oldValue&&r(t)}catch(e){console.error("解析存储值时出错:",e)}};(0,i.useEffect)(()=>(window.addEventListener("storage",s),()=>{window.removeEventListener("storage",s)}),[])};var l=r(19590),u=r(10190),d=r(9589),c=r(90885),h=r(3666),g=r(1233),m=r(65103),v=r(31074),b=r(16190),p=r(15692);function f(e){let{serverLogin:t}=e,r=(0,b.useTranslations)(),{logout:f}=(0,n.J)();(0,m.RH)([[p.q,()=>({login:t,refresh:()=>Promise.resolve()})]]);let[P,w]=(0,g.fp)(p.q);a({key:"accessToken",callback:e=>{!!e!==P.login&&w(t=>({...t,login:!!e}))}});let k=(0,u.A)(e=>e.setUserData),y=(0,c.useQuery)({queryKey:["self-info"],queryFn:l.Rc,enabled:P.login,refetchOnWindowFocus:!1,refetchOnMount:!1}),E=(0,i.useCallback)(async()=>{localStorage.getItem("accessToken")&&w(e=>({...e,login:!0})),await y.refetch()},[y.refetch,w]);(0,i.useEffect)(()=>{w(e=>({...e,refresh:E}))},[E,w]),(0,i.useEffect)(()=>{y.data&&(k(y.data),y.data._id&&window.gtag&&(window.gtag("config","G-8SWSJWECYN",{user_id:y.data._id}),(0,d.sendGTMEvent)({user_id:y.data._id})))},[y.data,k]);let C=(0,h.useMutation)({mutationFn:l.IO,onSuccess:async e=>{e>0&&(s.oR.success(r("mine.dailyRubySuccess",{ruby:e})),y.refetch())},onError:e=>{console.error(e)}}),x=(0,v.useCookies)();return(0,i.useEffect)(()=>{let e=localStorage.getItem("accessToken");if(P.login&&e)return void x.set("accessToken",e,{path:"/",expires:720});P.login||e||x.remove("accessToken")},[P.login]),(0,o.E)(()=>{P.login&&C.mutate()},[P.login]),(0,i.useEffect)(()=>{let e=()=>{f()};return window.addEventListener("app-logout",e),()=>{window.removeEventListener("app-logout",e)}},[f]),null}}},e=>{var t=t=>e(e.s=t);e.O(0,[1093,2090,2164,6190,8927,3602,9324,5978,1937,4784,1781,9124,2292,9589,7824,9884,148,8688,1401,9590,4307,6616,1845,8921,9483,7358],()=>t(80518)),_N_E=e.O()}]);