"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1845,1876],{2240:(e,t,l)=>{l.d(t,{d:()=>d});var i=l(53400),n=l(25878),r=l(50122),s=l(14692),a=l(92380),o=l(40965),c=l(16190);let d=e=>{var t,l;let{queryKey:d,queryFn:u,queryEnabled:h=!0,renderList:m,className:f,initialPageParam:x=0,staleTime:g=12e4,refetchOnWindowFocus:p=!1,refetchOnMount:v=!1,nothingSize:w,nothingClassName:b,select:j,...N}=e,y=(0,c.useTranslations)(),k=(0,o.useInfiniteQuery)({queryKey:d,initialPageParam:x,staleTime:g,refetchOnWindowFocus:p,refetchOnMount:v,queryFn:u,select:j,getNextPageParam:e=>{var t;if(e)return null!=(t=e.nextPage)?t:void 0},enabled:h}),A=null!=(l=null==(t=k.data)?void 0:t.pages.flatMap(e=>e.data))?l:[];return(0,i.jsxs)("div",{className:(0,a.cn)("w-full overflow-y-auto scrollbar-hide",f),...N,children:[(0,i.jsx)("div",{className:(0,a.cn)("h-0 w-full flex items-center justify-center text-white transition-all duration-300 opacity-0",(k.isLoading||k.isRefetching)&&"h-12 opacity-100"),children:(0,i.jsx)("span",{className:"i-eos-icons-three-dots-loading text-xl md:text-2xl"})}),(null==A?void 0:A.length)||k.hasNextPage?(0,i.jsxs)(i.Fragment,{children:[m(A),k.hasNextPage?(0,i.jsx)(s.A,{loadFn:k.fetchNextPage,loadCondition:!k.isFetching&&!k.isLoading,children:(0,i.jsx)("div",{className:"w-full h-16 flex items-center justify-center text-white/80",children:(0,i.jsx)(r.A.IconSpinner,{className:"text-xl md:text-2xl animate-spin"})})}):(0,i.jsx)("div",{className:"w-full h-16 flex items-center justify-center text-white/80 text-sm",children:y("global.nothingMore")})]}):!k.isLoading&&(0,i.jsx)("div",{className:(0,a.cn)("w-full h-full flex items-center justify-center"),children:(0,i.jsx)(n.A,{className:(0,a.cn)("mt-0",b),size:w})})]})}},14692:(e,t,l)=>{l.d(t,{A:()=>s});var i=l(53400),n=l(48276),r=l(14833);function s(e){let{rootId:t,children:l,loadFn:s,loadCondition:a,loadTimeout:o=500,inViewOptions:c,...d}=e,{ref:u,isIntersecting:h}=function(){var e;let{threshold:t=0,getRoot:l,root:i=null,rootMargin:s="0%",freezeOnceVisible:a=!1,initialIsIntersecting:o=!1,onChange:c}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[d,u]=(0,n.useState)(null),[h,m]=(0,n.useState)(()=>({isIntersecting:o,entry:void 0})),f=(0,n.useRef)(null);f.current=c;let x=(null==(e=h.entry)?void 0:e.isIntersecting)&&a;(0,n.useEffect)(()=>{var e;let n;if(!d||!("IntersectionObserver"in window)||x)return;let o=new IntersectionObserver(e=>{let t=(0,r.c)(o.thresholds)?o.thresholds:[o.thresholds];for(let l of e){let e=l.isIntersecting&&t.some(e=>l.intersectionRatio>=e);m({isIntersecting:e,entry:l}),f.current&&f.current(e,l),e&&a&&n&&(n(),n=void 0)}},{threshold:t,root:null!=(e=null==l?void 0:l())?e:i,rootMargin:s});return o.observe(d),()=>{o.disconnect()}},[d,JSON.stringify(t),i,s,x,a]);let g=(0,n.useRef)(null);(0,n.useEffect)(()=>{var e;d||null==(e=h.entry)||!e.target||a||x||g.current===h.entry.target||(g.current=h.entry.target,m({isIntersecting:o,entry:void 0}))},[d,h.entry,a,x,o]);let p=[u,!!h.isIntersecting,h.entry];return p.ref=p[0],p.isIntersecting=p[1],p.entry=p[2],p}({rootMargin:"1000px 0px",getRoot:()=>{var e;return t?null==(e=document)?void 0:e.getElementById(t):null},...c}),[m,f]=(0,n.useState)(!1),[x,g]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{setTimeout(()=>{f(!0)},1500)},[]),(0,n.useEffect)(()=>{if(h&&a&&m&&x){let e=async()=>{try{await s()}catch(e){console.error("InViewLoader: Error loading data",e)}finally{setTimeout(()=>g(!0),o)}};g(!1),e()}},[h,a,m,x,s,o]),(0,i.jsx)("div",{ref:u,...d,children:l})}},17955:(e,t,l)=>{l.d(t,{Fi:()=>v,Jb:()=>m,Oy:()=>f,UR:()=>x,jl:()=>g});var i=l(68885),n=l(60224),r=l(26497),s=l(81668),a=l(39661),o=l(54216),c=l(66726),d=l(47173),u=l(50122),h=l(49656);let m={discover:"/explore",memory:"/memory",topup:"/topup",mine:"/mine",message:"/message"},f=[{$title:"explore",icon:s.default,activeIcon:r.default,href:m.discover},{$title:"memory",icon:o.default,activeIcon:a.default,href:m.memory},{$title:"topup",icon:n.default,activeIcon:i.default,href:m.topup},{$title:"message",icon:d.default,activeIcon:c.default,href:m.message}],x={wallet:"/mine",mobileWallet:"/mine/wallet",profile:"/mine/profile",setting:"/mine/setting",character:"/mine/character",moment:"/mine/moment",chatMoment:"/mine/chat-moment",memory:"/mine/memory",chatArchive:"/mine/chat-archive",followCharacter:"/mine/follow-character",subscribes:"/mine/subscribes",subscribers:"/mine/subscribers",invite:"/mine/invite"},g=[{$title:"mine.self.balance",href:x.wallet,mobileHref:x.mobileWallet},{$title:"mine.self.chatMoment",href:x.chatMoment},{$title:"mine.self.createMoment",href:x.moment},{$title:"mine.self.createCharacter",href:x.character},{$title:"mine.self.memory",href:x.memory},{$title:"mine.self.chatArchive",href:x.chatArchive}],p=[{title:"简体中文",locale:h.hT.ZH},{title:"繁體中文",locale:h.hT.ZH_HANT},{title:"English",locale:h.hT.EN},{title:"日本語",locale:h.hT.JA},{title:"한국어",locale:h.hT.KO},{title:"ภาษาไทย",locale:h.hT.TH}],v=[{$title:"leftNavigation.overview",icon:u.A.IconOrder,children:[{$title:"leftNavigation.termsOfService",href:"/terms-of-service",openNewTag:!0},{$title:"leftNavigation.privacyPolicy",href:"/privacy-policy",openNewTag:!0},{$title:"leftNavigation.contactUs",href:"/contact-us",openNewTag:!0},{$title:"leftNavigation.blog",href:"/blog",openNewTag:!0},{$title:"leftNavigation.sitemap",href:"/sitemap",openNewTag:!0}]},{$title:"global.language.switch",icon:u.A.IconGlobal,children:p},{$title:"leftNavigation.guideBook",icon:u.A.IconBook,href:"https://rubii.gitbook.io",openNewTag:!0},{$title:"leftNavigation.blockedUser",icon:u.A.IconUser,href:"/mine/blocked-user",onlyLogin:!0},{$title:"leftNavigation.affiliate",icon:u.A.IconAffiliate,href:"https://rubii.affonso.io",openNewTag:!0,onlyLogin:!1}]},21876:(e,t,l)=>{l.r(t),l.d(t,{default:()=>i});let i={src:"/_next/static/media/zero.2a309680.png",height:240,width:240,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAUVBMVEWBgYGxsbGjo6MyMjJycnJpaWlkZGQrKytwcHAwMDBeXl6Li4uIiIh+fn6Li4tycnKKiop+fn5QUFBtbW0tLS1gYGBoaGhTU1OTk5Oenp59fX23NpkvAAAAGHRSTlMB+/xYbVj+EyYw+/373LH347W+3YuP1unqbCkFAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAPUlEQVR4nAXBBwKAIAwAsWOWKW4L/3+oCeBykgxwlve7gbTPth5gm7XVLuDVWL0Eghq7OuBjLOMQIAeX4AdVkAI9oA8bqQAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}},25878:(e,t,l)=>{l.d(t,{A:()=>o});var i=l(53400),n=l(21876),r=l(92380),s=l(16190),a=l(36405);let o=e=>{let{className:t,size:l=100,textClassName:o,...c}=e,d=(0,s.useTranslations)("common");return(0,i.jsxs)("section",{className:(0,r.cn)("mt-6 w-full flex justify-center items-center flex-col",t),...c,children:[(0,i.jsx)(a.default,{src:n.default,alt:"zero",width:l,height:l}),(0,i.jsx)("h2",{className:(0,r.cn)("mt-2 leading-5 text-white/80 text-xs",o),children:d("noThing")})]})}},26497:(e,t,l)=>{l.r(t),l.d(t,{default:()=>i});let i={src:"/_next/static/media/icon-discover-active.d434464b.svg",height:24,width:24,blurWidth:0,blurHeight:0}},39661:(e,t,l)=>{l.r(t),l.d(t,{default:()=>i});let i={src:"/_next/static/media/icon-memory-active.4c69eef2.svg",height:24,width:24,blurWidth:0,blurHeight:0}},41203:(e,t,l)=>{l.d(t,{FB:()=>c,Gu:()=>s,eF:()=>a,gw:()=>u,qy:()=>r,sn:()=>d,tS:()=>o});var i=l(53400),n=l(48276);let r=e=>e.length>0,s=(e,t)=>e.includes(t),a=(e,t)=>s(e,t)?e:[...e,t],o=(e,t)=>e.filter(e=>e!==t),c=n.createContext(void 0);function d(e){let t=(0,n.useContext)(c);if(!t)throw Error("Wait must be used within a Waiter");return t.waiters.includes(e.on)?(0,i.jsx)(i.Fragment,{children:e.fallback}):(0,i.jsx)(i.Fragment,{children:e.children})}function u(){let e=(0,n.useContext)(c);if(!e)throw Error("useWait must be used within a Waiter");return{...e,Wait:d}}},43889:(e,t,l)=>{l.d(t,{U:()=>r});var i=l(48276),n=l(70712);function r(e){let{defaultValue:t=!1,initializeWithValue:l=!0,onMatch:r,onUnMatch:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=(0,i.useMemo)(()=>"string"==typeof e?e:"(min-width: ".concat(e,"px)"),[e]),o=e=>window.matchMedia(e).matches,[c,d]=(0,i.useState)(()=>l?o(a):t);function u(){let e=o(a);d(e),e?null==r||r():null==s||s()}return(0,n.E)(()=>{let e=window.matchMedia(a);return u(),e.addListener?e.addListener(u):e.addEventListener("change",u),()=>{e.removeListener?e.removeListener(u):e.removeEventListener("change",u)}},[a]),c}},47173:(e,t,l)=>{l.r(t),l.d(t,{default:()=>i});let i={src:"/_next/static/media/icon-notice.af2f7570.svg",height:24,width:24,blurWidth:0,blurHeight:0}},49460:(e,t,l)=>{l.d(t,{l:()=>r});var i=l(49656),n=l(83398);function r(){let e=(0,n.usePathname)(),t=e.split("/").filter(Boolean),l=t[0];return i.IB.includes(l)?"/".concat(t.slice(1).join("/")):e}},54216:(e,t,l)=>{l.r(t),l.d(t,{default:()=>i});let i={src:"/_next/static/media/icon-memory.7f1db607.svg",height:24,width:24,blurWidth:0,blurHeight:0}},55766:(e,t,l)=>{l.d(t,{w:()=>i});let i=(0,l(72197).eU)(!1)},60224:(e,t,l)=>{l.r(t),l.d(t,{default:()=>i});let i={src:"/_next/static/media/icon-billing.f6e3348c.svg",height:24,width:24,blurWidth:0,blurHeight:0}},63058:(e,t,l)=>{l.d(t,{U:()=>i});let i=l(12292).P.div},66726:(e,t,l)=>{l.r(t),l.d(t,{default:()=>i});let i={src:"/_next/static/media/icon-notice-active.685fbece.svg",height:24,width:24,blurWidth:0,blurHeight:0}},68016:(e,t,l)=>{l.d(t,{S:()=>o});var i=l(53400),n=l(18168),r=l(51401),s=l(48276),a=l(92380);let o=s.forwardRef((e,t)=>{let{className:l,...s}=e;return(0,i.jsx)(n.bL,{ref:t,className:(0,a.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",l),...s,children:(0,i.jsx)(n.C1,{className:(0,a.cn)("flex items-center justify-center text-current"),children:(0,i.jsx)(r.A,{className:"h-4 w-4"})})})});o.displayName=n.bL.displayName},68885:(e,t,l)=>{l.r(t),l.d(t,{default:()=>i});let i={src:"/_next/static/media/icon-billing-active.4a67d4d0.svg",height:24,width:24,blurWidth:0,blurHeight:0}},71022:(e,t,l)=>{l.d(t,{B:()=>n});var i=l(48276);function n(e,t){let{onSuccess:l,onError:n}=t,r=(0,i.useRef)(l),s=(0,i.useRef)(n);return(0,i.useEffect)(()=>{r.current=l,s.current=n},[l,n]),(0,i.useEffect)(()=>{e.data&&r.current&&r.current(e.data)},[e.data]),(0,i.useEffect)(()=>{e.error&&s.current&&s.current(e.error)},[e.error]),{data:e.data,error:e.error,isFetching:e.isFetching,refetch:e.refetch}}},78367:(e,t,l)=>{l.r(t),l.d(t,{ClientHook:()=>L,default:()=>T});var i=l(53400),n=l(23785);let r={src:"/_next/static/media/closeCircle.317101b0.svg",height:24,width:24,blurWidth:0,blurHeight:0};var s=l(63058),a=l(10190),o=l(36405),c=l(48276);let d={src:"/_next/static/media/email.9140c5d4.svg",height:24,width:24,blurWidth:0,blurHeight:0},u={src:"/_next/static/media/eyeClose.7f448c93.svg",height:16,width:16,blurWidth:0,blurHeight:0},h={src:"/_next/static/media/eyeOpen.2bde122f.svg",height:16,width:16,blurWidth:0,blurHeight:0},m={src:"/_next/static/media/loginButton.dfee0a03.svg",height:56,width:400,blurWidth:0,blurHeight:0},f={src:"/_next/static/media/password.8731572b.svg",height:24,width:24,blurWidth:0,blurHeight:0},x={src:"/_next/static/media/verification.58c75fdd.svg",height:24,width:24,blurWidth:0,blurHeight:0};var g=l(87555),p=l(61281),v=l(41401),w=l(102),b=l(84467),j=l(92380),N=l(16190),y=l(51093),k=l.n(y),A=l(54402);function C(){let e=(0,N.useTranslations)("login"),[t,l]=(0,c.useState)(""),[r,s]=(0,c.useState)(""),[u,h]=(0,c.useState)(""),[p,b]=(0,c.useState)(!1),[j,y]=(0,c.useState)(0),k=(0,a.A)(e=>e.setShowSetPassword),C=(0,a.A)(e=>e.setShowLogin),S=(0,a.A)(e=>e.setUserData),_=(0,a.A)(e=>e.setHasCodeLogin),E=(0,c.useRef)(null);(0,c.useEffect)(()=>{let e;return j>0?e=setTimeout(()=>y(j-1),1e3):b(!1),()=>clearTimeout(e)},[j]);let L=async l=>{if(l.preventDefault(),!t||!u)return;if(u.length<6)return void n.oR.error(e("valid.password"));let i=(0,g.Cs)();try{let e=await (0,w.C9)({email:t,otp:r,password:u});if(e){let{session:t,user:l}=e,i=null==t?void 0:t.access_token,n=null==t?void 0:t.refresh_token;l&&S(l),i&&n&&(localStorage.setItem("accessToken",i),localStorage.setItem("refreshToken",n),C(!1),_(!0))}}catch(e){console.error(e)}finally{i()}},T=async()=>{var l;if(p)return;if(!t)return void n.oR.error(e("valid.email"));let i=null==(l=E.current)?void 0:l.getValue();if(!i)return void n.oR.error(e("valid.captcha"));try{await (0,w.Kx)(t,"recovery",i),b(!0),y(60)}catch(t){n.oR.error(e("reset.errorSendOtp"))}};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center mb-8",children:[(0,i.jsx)("button",{type:"button",className:"cursor-pointer",onClick:()=>k(!1),children:(0,i.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,i.jsx)("title",{children:e("resetPassword")}),(0,i.jsx)("path",{d:"M15 18L9 12L15 6",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,i.jsx)("h1",{className:"text-2xl font-bold leading-[28px] md:leading-[35px] ml-4",children:e("resetPassword")})]}),(0,i.jsxs)("form",{className:"flex w-full flex-col space-y-6",onSubmit:L,children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("div",{className:"absolute left-4 top-1/2 -translate-y-1/2",children:(0,i.jsx)(o.default,{src:d,alt:"email",width:24,height:24})}),(0,i.jsx)("input",{type:"email",placeholder:e("enterEmail"),value:t,onChange:e=>l(e.target.value),required:!0,className:"h-[48px] md:h-[56px] w-full rounded-md bg-inputBg pl-[56px] pr-2 text-white outline-none placeholder:text-white/50 placeholder:text-base placeholder:leading-[23px]"})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("div",{className:"absolute left-4 top-1/2 -translate-y-1/2",children:(0,i.jsx)(o.default,{src:x,alt:"verification",width:24,height:24})}),(0,i.jsx)("input",{type:"text",placeholder:e("enterVerificationCode"),required:!0,className:"h-[48px] md:h-[56px] w-full rounded-md bg-inputBg pl-[56px] pr-24 text-white outline-none placeholder:text-white/50 placeholder:text-base placeholder:leading-[23px]",value:r,onChange:e=>s(e.target.value)}),(0,i.jsx)("button",{type:"button",onClick:p?void 0:T,className:"absolute right-4 top-1/2 -translate-y-1/2 text-sm ".concat(p?"text-white/50":"cursor-pointer text-[#0DCAFF]"),children:p?"".concat(j,"s"):e("getCode")})]}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("div",{className:"absolute left-4 top-1/2 -translate-y-1/2",children:(0,i.jsx)(o.default,{src:f,alt:"password",width:24,height:24})}),(0,i.jsx)("input",{type:"password",placeholder:e("reset.setNewPassword"),required:!0,className:"h-[48px] md:h-[56px] w-full rounded-md bg-inputBg pl-[56px] pr-2 text-white outline-none placeholder:text-white/50 placeholder:text-base placeholder:leading-[23px]",value:u,onChange:e=>h(e.target.value)})]}),(0,i.jsx)("div",{className:"flex flex-col items-center justify-center",children:(0,i.jsxs)("button",{type:"submit",className:"h-[44px] md:h-[56px] w-full relative",children:[(0,i.jsx)(o.default,{src:m,alt:"login button",fill:!0,className:"object-cover rounded-lg"}),(0,i.jsx)("span",{className:"relative z-10",children:e("confirm")})]})}),(0,i.jsx)("div",{className:"mt-4 google-captcha",children:(0,i.jsx)(A.A,{ref:E,sitekey:v._A,theme:"dark"})})]})]})}let S=[{title:"email",cpn:(0,i.jsx)(function(){let e=(0,N.useTranslations)("login"),t=(0,p.J)(),[l,r]=(0,c.useState)(!0),[s,y]=(0,c.useState)(""),[C,S]=(0,c.useState)(""),_=(0,a.A)(e=>e.setShowSetPassword),E=(0,a.A)(e=>e.setShowLogin),L=(0,a.A)(e=>e.setUserData),T=(0,a.A)(e=>e.setHasCodeLogin),[I,R]=(0,c.useState)(!1),[W,F]=(0,c.useState)(""),P=(0,a.A)(e=>e.invitorId),[B,z]=(0,c.useState)(!1),[M,U]=(0,c.useState)(0),$=(0,c.useRef)(null);(0,c.useEffect)(()=>{let e;return M>0?e=setTimeout(()=>U(M-1),1e3):z(!1),()=>clearTimeout(e)},[M]),(0,c.useEffect)(()=>{let e=document.createElement("script");return e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>{if(!window.google)return;window.google.accounts.id.initialize({client_id:"927433895136-og0bifsat9p0drni9jrahsbu564drl7d.apps.googleusercontent.com",callback:D});let e=document.getElementById("googleButton");e&&window.google.accounts.id.renderButton(e,{theme:"filled_black",size:"large",shape:"circular",logoAlignment:"center",width:e.offsetWidth-10})},document.body.appendChild(e),()=>{document.body.removeChild(e)}},[]),(0,c.useEffect)(()=>{let e=document.createElement("script");return e.src="https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js",e.async=!0,e.defer=!0,e.onload=()=>{window.AppleID&&window.AppleID.auth.init({clientId:"ai.rubii.www",scope:"email name",redirectURI:"https://rubii.ai",usePopup:!0})},document.body.appendChild(e),()=>{document.body.removeChild(e)}},[]);let D=async l=>{if(l.credential){let i=(0,g.Cs)();try{let e=await (0,w.l)(l.credential,P||void 0);if(e){let{session:l,user:i,is_new_user:n}=e,r=null==l?void 0:l.access_token,a=null==l?void 0:l.refresh_token;i&&L(i),r&&a&&(localStorage.setItem("accessToken",r),localStorage.setItem("refreshToken",a),E(!1),T(!0),await t.refresh(),n&&window.Affonso&&(window.Affonso.signup(s),(0,b.b)("register",{user_id:null==i?void 0:i._id})))}}catch(t){console.error("Google login error:",t),n.oR.error(e("loginFailed"))}finally{i()}}},H=async()=>{if(!window.AppleID)return void n.oR.error(e("appleLoginError"));let l=(0,g.Cs)();try{let e=await window.AppleID.auth.signIn();if(null==e?void 0:e.authorization){let{id_token:l,code:i}=e.authorization,n=e.user,r=await (0,w.Wl)({id_token:l,authorization_code:i,user_data:n?{email:n.email,name:n.name?{firstName:n.name.firstName,lastName:n.name.lastName}:void 0}:void 0,invitor_id:P||void 0});if(r){let{session:e,user:l,is_new_user:i}=r,s=null==e?void 0:e.access_token,a=null==e?void 0:e.refresh_token;if(l&&L(l),s&&a&&(localStorage.setItem("accessToken",s),localStorage.setItem("refreshToken",a),E(!1),T(!0),await t.refresh(),i&&window.Affonso)){let e=(null==l?void 0:l.email)||(null==n?void 0:n.email)||"";window.Affonso.signup(e),(0,b.b)("register",{user_id:null==l?void 0:l._id})}}}}catch(t){console.error("Apple login error:",t),(null==t?void 0:t.error)==="popup_closed_by_user"?n.oR.error(e("appleLoginCancelled")):n.oR.error(e("appleLoginError"))}finally{l()}},O=async()=>{var t;if(B)return;if(!s)return void n.oR.error(e("valid.email"));let l=null==(t=$.current)?void 0:t.getValue();if(!l)return void n.oR.error(e("valid.captcha"));try{await (0,w.Kx)(s,"signin",l),z(!0),U(60)}catch(t){n.oR.error(e("valid.captcha"))}},X=async i=>{if(i.preventDefault(),C.length<6)return void n.oR.error(e("valid.password"));let r={email:s,provider:l?"password":"otp",...""!==P?{invitor_id:P}:{},...l?{password:C}:{otp:W,password:C}},a=(0,g.Cs)();try{let e=await (0,w.G7)(r);if(e){let{session:l,user:i,is_new_user:n}=e,r=null==l?void 0:l.access_token,a=null==l?void 0:l.refresh_token;i&&L(i),r&&a&&(localStorage.setItem("accessToken",r),localStorage.setItem("refreshToken",a),E(!1),T(!0),await t.refresh(),"register"==(n?"register":"login")&&window.Affonso&&(window.Affonso.signup(s),(0,b.b)("register",{user_id:null==i?void 0:i._id})))}}catch(e){console.error("Error during login:",e)}finally{a()}},V=()=>!!s&&(l?C.length>=6:C.length>=6&&W.length>0);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h1",{className:"text-2xl font-bold leading-[28px] md:leading-[35px]",children:l?e("emailLogin"):e("emailRegister")}),(0,i.jsxs)("form",{className:"flex w-full flex-col",onSubmit:X,children:[(0,i.jsxs)("div",{className:"relative mb-4 mt-8",children:[(0,i.jsx)("div",{className:"absolute left-4 top-1/2 -translate-y-1/2",children:(0,i.jsx)(o.default,{src:d,alt:"email",width:24,height:24})}),(0,i.jsx)("input",{type:"email",placeholder:e("enterEmail"),value:s,onChange:e=>y(e.target.value),required:!0,className:"h-[48px] md:h-[56px] w-full rounded-md bg-inputBg pl-[56px] pr-2 text-white outline-none placeholder:text-white/50 placeholder:text-base placeholder:leading-[23px]"})]}),!l&&(0,i.jsxs)("div",{className:"relative mb-4",children:[(0,i.jsx)("div",{className:"absolute left-4 top-1/2 -translate-y-1/2",children:(0,i.jsx)(o.default,{src:x,alt:"verification",width:24,height:24})}),(0,i.jsx)("input",{type:"text",placeholder:e("enterVerificationCode"),required:!0,className:"h-[48px] md:h-[56px] w-full rounded-md bg-inputBg pl-[56px] pr-24 text-white outline-none placeholder:text-white/50 placeholder:text-base placeholder:leading-[23px]",value:W,onChange:e=>F(e.target.value)}),(0,i.jsx)("button",{type:"button",onClick:B?void 0:O,className:"absolute right-4 top-1/2 -translate-y-1/2 text-sm ".concat(B?"text-white/50":"cursor-pointer text-[#0DCAFF]"),children:B?"".concat(M,"s"):e("getCode")})]}),(0,i.jsxs)("div",{className:"relative mb-4",children:[(0,i.jsx)("div",{className:"absolute left-4 top-1/2 -translate-y-1/2",children:(0,i.jsx)(o.default,{src:f,alt:"password",width:24,height:24})}),(0,i.jsx)("input",{type:I?"text":"password",placeholder:e("enterPassword"),required:!0,className:"h-[48px] md:h-[56px] w-full rounded-md bg-inputBg pl-[56px] pr-2 text-white outline-none placeholder:text-white/50 placeholder:text-base placeholder:leading-[23px]",value:C,onChange:e=>S(e.target.value)}),(0,i.jsx)(o.default,{src:I?h:u,alt:e("togglePasswordVisibility"),width:24,height:24,className:"absolute right-4 top-1/2 -translate-y-1/2 cursor-pointer opacity-50",onClick:()=>R(!I)})]}),l&&(0,i.jsx)("div",{className:"flex justify-end mt-3",children:(0,i.jsx)("button",{type:"button",className:"text-[#0DCAFF] cursor-pointer text-sm",onClick:()=>_(!0),children:e("forgotPassword")})}),!l&&(0,i.jsx)("div",{className:"mt-4 google-captcha",children:(0,i.jsx)(A.A,{ref:$,sitekey:v._A,theme:"dark"})}),(0,i.jsx)("div",{className:(0,j.cn)("flex flex-col items-center justify-center h-full",l?"mt-8":"mt-4"),children:(0,i.jsxs)("button",{type:"submit",disabled:!V(),className:"h-[44px] md:h-[56px] w-full relative",children:[(0,i.jsx)(o.default,{src:m,alt:"login button",fill:!0,className:"object-cover rounded-lg ".concat(V()?"":"opacity-50")}),(0,i.jsx)("span",{className:"relative z-10 ".concat(V()?"":"opacity-50"),children:l?e("loginButton"):e("loginRegister")})]})}),(0,i.jsxs)("div",{className:"mt-[16px] md:mt-[21px] flex items-center justify-center gap-1",children:[(0,i.jsx)("span",{className:"text-white/50 text-sm",children:l?e("noAccount"):e("haveAccount")}),(0,i.jsx)("button",{type:"button",className:"cursor-pointer text-[#0DCAFF] text-sm",onClick:()=>{r(!l)},children:l?e("register"):e("signin")})]})]}),(0,i.jsx)("div",{className:"mt-4 -mr-[10px]",id:"googleButton"}),(0,i.jsxs)("button",{type:"button",onClick:H,className:"mt-3 w-full h-[44px] bg-white text-black rounded-md flex items-center justify-center gap-2 font-medium hover:bg-gray-100 transition-colors",children:[(0,i.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:(0,i.jsx)("path",{d:"M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"})}),(0,i.jsx)("span",{children:e("continueWithApple")})]}),(0,i.jsxs)("div",{className:"w-full text-center text-xs text-gray-400 pt-4 mt-auto leading-5",children:[e("agreementPrefix")," ",(0,i.jsx)(k(),{href:"/terms-of-service",prefetch:!1,onClick:()=>E(!1),className:"text-white",children:e("termsOfService")}),(0,i.jsx)("br",{}),e("agreementSuffix")," ",(0,i.jsx)(k(),{href:"/privacy-policy",prefetch:!1,onClick:()=>E(!1),className:"text-white",children:e("privacyPolicy")}),(0,i.jsx)("p",{children:e("confirmAge")})]})]})},{})}];function _(){let[e]=(0,c.useState)(0),t=(0,a.A)(e=>e.setShowLogin),l=(0,a.A)(e=>e.showSetPassword);return(0,i.jsx)(s.U,{id:"signin-modal",className:"fixed z-40 inset-0 flex h-[100dvh] w-screen text-white items-center justify-center bg-black/60",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:(0,i.jsxs)(s.U,{className:"relative flex h-[570px] md:h-[750px] w-[464px] max-w-[90%] flex-col rounded-2xl bg-cardBg p-6 md:p-8",initial:{scale:.95,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:20},transition:{duration:.2,ease:"easeOut"},children:[(0,i.jsx)(o.default,{src:r,alt:"close",width:24,height:24,className:"absolute right-6 md:right-8 top-7 md:top-8 cursor-pointer",onClick:()=>t(!1)}),l?(0,i.jsx)(C,{}):S[e].cpn]})})}var E=l(83398);let L=()=>{let e=(0,N.useTranslations)("topup"),t=(0,E.useSearchParams)(),l=(0,a.A)(e=>e.showLogin),r=(0,a.A)(e=>e.setInvitorId),s=async()=>{let l=t.get("transactionId"),i=t.get("status");l&&"S"===i&&setTimeout(()=>{(0,b.b)("purchase",{ecommerce:{transaction_id:l,value:7.99,currency:"USD"}}),n.oR.success(e("paymentSuccessful"));let t=new URL(window.location.href);t.searchParams.delete("transactionId"),t.searchParams.delete("status"),window.history.replaceState({},"",t.toString())},200)},o=async()=>{let l=t.get("product_id"),i=t.get("order_id");if(l&&i){let t={prod_1dySTvtxmJstxwwJ1RrL3B:7.99,prod_231G4jwim677McxmhzRFDq:14.99,prod_5uLUSrGusJAAd0cWpvhefw:29.99,prod_2OUNggZSwrxl5CtaRkvgI7:6,prod_3IiEZKhcjWEGPKUPqWWzDT:10,prod_6Ub796QGbEpdZTnFFKlGrV:20,prod_1efJZSXElmgA8REZ65Vk4s:30,prod_69WkHVRC39Pu1znNy6ixuX:50}[l];void 0!==t&&setTimeout(()=>{(0,b.b)("purchase",{ecommerce:{transaction_id:i,value:t,currency:"USD",items:[{item_id:t.toString(),item_name:t.toString()}]}}),n.oR.success(e("paymentSuccessful"));let l=new URL(window.location.href);l.searchParams.delete("product_id"),l.searchParams.delete("order_id"),window.history.replaceState({},"",l.toString())},200)}};return(0,c.useEffect)(()=>{s(),o()},[]),(0,c.useEffect)(()=>{let e=t.get("invitor_id");e&&r(e)},[]),l?(0,i.jsx)(_,{}):null},T=L},81668:(e,t,l)=>{l.r(t),l.d(t,{default:()=>i});let i={src:"/_next/static/media/icon-discover.d8bbe123.svg",height:24,width:24,blurWidth:0,blurHeight:0}},84467:(e,t,l)=>{l.d(t,{b:()=>n});var i=l(9589);let n=(e,t,l)=>{(0,i.sendGTMEvent)({event:e,...t},l)}},98759:(e,t,l)=>{l.r(t),l.d(t,{LeftNavigation:()=>ec,default:()=>ed});var i=l(53400),n=l(1233),r=l(65103),s=l(36405),a=l(51093),o=l.n(a),c=l(48276),d=l(61281),u=l(43889),h=l(14833),m=l(70712),f=l(49460),x=l(32015),g=l(41401),p=l(92380),v=l(55766),w=l(90885),b=l(3666),j=l(16190),N=l(23785),y=l(50122),k=l(68016),A=l(25504),C=l(71022),S=l(41203),_=l(53227);let E=()=>{let{startWaiting:e,isWaiting:t,endWaiting:l}=(0,S.gw)(),n=(0,j.useTranslations)("leftNavigation"),r=(0,j.useTranslations)("global"),s=["PG","PG13","R","R+"],[a,o]=(0,c.useState)([]),[d,u]=(0,c.useState)(!1),h=(0,c.useRef)([]),m=(0,w.useQuery)({queryKey:["userRatingPreferences"],queryFn:_.$t,staleTime:Number.POSITIVE_INFINITY,refetchOnWindowFocus:!1,refetchOnMount:!1});(0,C.B)(m,{onSuccess:e=>{o(e),h.current=e}}),(0,c.useEffect)(()=>{m.isError&&(o(s),h.current=s)},[m.isError,s]),(0,c.useEffect)(()=>{d&&(h.current=[...a])},[d]);let f=(0,b.useMutation)({mutationFn:_.zW,onSuccess:()=>{m.refetch(),N.oR.success(r("contentSettingUpdated")),setTimeout(()=>{window.location.reload()},2e3)},onError:e=>{console.error("Update failed:",e),o(h.current),N.oR.error(r("updateFailed"))}}),x=(0,c.useCallback)(e=>{f.isPending||o(t=>{let l=t.includes(e)?t.filter(t=>t!==e):[...t,e];return 0===l.length?(N.oR.info(r("selectAtLeastOne")),t):l})},[f.isPending,r]),g=(0,c.useCallback)(async t=>{if(t)h.current=[...a],u(!0);else{if(JSON.stringify([...a].sort())!==JSON.stringify([...h.current].sort())&&!f.isPending&&a.length>0){e("content-setting-save");try{await f.mutateAsync(a)}finally{l("content-setting-save")}}u(!1)}},[a,f,e,l]);return(0,i.jsxs)(A.DropdownMenu,{open:d,onOpenChange:g,children:[(0,i.jsx)(A.DropdownMenuTrigger,{className:"outline-none",children:(0,i.jsx)("div",{className:"h-8 w-8 rounded-[8px] bg-[#2B2D33] hover:bg-[#464953] outline-none items-center justify-center flex",children:m.isPending||t("content-setting-save")?(0,i.jsx)(y.A.IconSpinner,{}):(0,i.jsx)(y.A.IconEye,{})})}),(0,i.jsxs)(A.DropdownMenuContent,{side:"bottom",align:"end",className:"bg-[#2B2D33] border border-white/10 rounded-[8px] text-white p-0 w-44 ml-4",children:[(0,i.jsx)("div",{className:"px-4 py-2 text-center text-sm font-medium border-b border-white/10",children:n("contentSetting")}),s.map(e=>{let t=a.includes(e);return(0,i.jsxs)(A.DropdownMenuItem,{className:"flex items-center justify-between px-4 py-2 hover:bg-[#464953] cursor-pointer",onClick:t=>{t.preventDefault(),x(e)},disabled:f.isPending,children:[(0,i.jsx)("span",{className:"text-sm",children:e}),(0,i.jsx)(k.S,{checked:t,className:"data-[state=checked]:bg-h5-primary rounded-md border-white/50"})]},e)})]})]})},L={src:"/_next/static/media/create-button.85f9559f.svg",height:20,width:24,blurWidth:0,blurHeight:0};var T=l(85261),I=l(98169);let R=(0,c.memo)(e=>(0,i.jsxs)("svg",{width:"1em",height:"1em",viewBox:"0 0 24 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,i.jsx)("title",{children:"Create Star"}),(0,i.jsx)("rect",{x:"0.75",y:"0.75",width:"22.5",height:"18.5",rx:"5.91667",stroke:"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,i.jsx)("path",{d:"M11.5961 5.59539C11.7022 5.17619 12.2978 5.17619 12.4039 5.59539L13.0636 8.20099C13.135 8.48283 13.3481 8.70711 13.6259 8.79278L15.7089 9.43517C16.1007 9.55601 16.1007 10.1107 15.7089 10.2315L13.6259 10.8739C13.3481 10.9596 13.135 11.1838 13.0636 11.4657L12.4039 14.0713C12.2978 14.4905 11.7022 14.4905 11.5961 14.0713L10.9364 11.4657C10.865 11.1838 10.6519 10.9596 10.3741 10.8739L8.2911 10.2315C7.89926 10.1107 7.89926 9.55601 8.2911 9.43517L10.3741 8.79278C10.6519 8.70711 10.865 8.48283 10.9364 8.20099L11.5961 5.59539Z",fill:"white",fontWeight:"bold"})]}));R.displayName="IconCreateStar";var W=l(78515),F=l(43619),P=l(1832),B=l(88133),z=l(10190);let M=e=>{var t;let{className:l}=e,n=(0,z.A)(e=>e.userData);return(0,i.jsx)("span",{className:(0,p.cn)("text-white text-sm font-normal leading-4",l),children:(0,B.Z)(null!=(t=null==n?void 0:n.token)?t:0,!0,0)})},U=e=>{let{userId:t,size:l=36}=e,n=(0,j.useTranslations)("login");return(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"rounded-full overflow-hidden mr-2 flex-shrink-0",style:{width:l,height:l},children:(0,i.jsx)(F.default,{id:t,size:l,type:"user",alt:"User avatar"})}),(0,i.jsxs)("div",{className:"flex items-center justify-between h-8 flex-shrink-0 rounded-2xl flex-1 pl-[6px] p-1 gap-1",style:{background:"linear-gradient(90deg, #2B2D33 0%, #161618 100%)",boxShadow:"-2px -2px 3px 0px #393E41 inset, 2px 2px 3px 0px #181619 inset"},children:[(0,i.jsx)(s.default,{src:W.default,alt:"Ruby",width:24,height:24,className:"flex-shrink-0 size-4 md:size-6"}),(0,i.jsx)(M,{className:"flex-1 leading-none"}),(0,i.jsx)(o(),{href:"/topup",prefetch:!1,className:"flex items-center h-full flex-shrink-0",children:(0,i.jsx)(P.A,{buttonType:"gradient",className:"px-3 h-full text-xs rounded-full whitespace-nowrap",children:n("subscribe")})})]})]})};var $=l(17955),D=l(41238);let H={src:"/_next/static/media/left-navigation-background.48e19882.svg",height:40,width:180,blurWidth:0,blurHeight:0};var O=l(63058);function X(e){let[t,l]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{let t=e.current;if(!t)return;let i=()=>{l(!0)},n=()=>{l(!1)};return t.addEventListener("mouseenter",i),t.addEventListener("mouseleave",n),()=>{t.removeEventListener("mouseenter",i),t.removeEventListener("mouseleave",n)}},[e]),t}var V=l(97308),G=l(83398);let q=e=>{let{id:t,href:l,avatarUrl:n,className:r}=e,a=(0,G.usePathname)(),d=(0,j.useTranslations)(),u=()=>t===a.split("/").pop(),h=(0,c.useRef)(null),m=X(h),f=u()||m;return(0,i.jsx)(o(),{href:l,prefetch:!1,children:(0,i.jsxs)("div",{ref:h,className:(0,p.cn)("flex items-center gap-1.5 px-0.5 rounded-md cursor-pointer relative",r),children:[(0,i.jsx)(V.N,{children:f&&(0,i.jsx)(O.U,{initial:{scaleX:0},animate:{scaleX:1},exit:{scaleX:0},transition:{duration:.2},style:{originX:0,position:"absolute",inset:0,zIndex:0},children:(0,i.jsx)(s.default,{src:H,alt:"nav-active-background",width:180,height:40,className:"absolute inset-0 object-cover"})})}),(0,i.jsx)("div",{className:"flex-shrink-0 z-10 py-0.5 pl-1.5",children:(0,i.jsx)("div",{className:(0,p.cn)("rounded-full w-[26px] h-[26px]"),children:(0,i.jsx)("div",{className:(0,p.cn)("rounded-full w-full h-full p-[1px]",(m||u())&&"bg-h5-block-gradient"),children:(0,i.jsx)(s.default,{src:n||"/images/assets/custom-preset.png",alt:"avatar",width:24,height:24,className:"w-full h-full rounded-full bg-slate-500 object-cover object-top"})})})}),(0,i.jsx)("div",{className:"flex-grow max-w-[90%] overflow-hidden z-10",children:(0,i.jsx)("span",{className:(0,p.cn)("text-sm md:text-base leading-4 select-none",f?"text-gradient bg-h5-block-gradient bg-clip-text":"text-white"),children:d("leftNavigation.mine")})})]})})};function J(e){let{icon:t,activeIcon:l,title:n,href:r,active:a,badge:d,className:u,...h}=e,m=(0,c.useRef)(null),f=X(m),x=a||f;return(0,i.jsx)("div",{ref:m,className:(0,p.cn)("flex cursor-pointer items-center text-xs h-[40px] font-bold",u),...h,children:(0,i.jsxs)(o(),{href:r,prefetch:!1,className:"flex items-center h-full w-full text-base font-normal px-2 relative",children:[(0,i.jsx)(V.N,{children:x&&(0,i.jsx)(O.U,{initial:{scaleX:0},animate:{scaleX:1},exit:{scaleX:0},transition:{duration:.2},style:{originX:0,position:"absolute",inset:0},children:(0,i.jsx)(s.default,{src:H,alt:"nav-active-background",width:180,height:40,className:"absolute inset-0 object-cover"})})}),(0,i.jsxs)("div",{className:"z-10 flex items-center gap-2",children:[(0,i.jsxs)("div",{className:"relative size-6 flex items-center justify-center",children:[(0,i.jsx)(s.default,{width:24,height:24,src:x?l:t,alt:"nav-icon",className:"size-6",priority:!0}),d&&(0,i.jsx)("div",{className:"absolute top-0 right-0",children:d})]}),(0,i.jsx)("span",{className:(0,p.cn)("text-sm md:text-base leading-4",x?"text-gradient bg-h5-block-gradient bg-clip-text":"text-white"),children:n})]})]})})}var K=l(41887),Z=l(79896),Q=l(86596),Y=l(21005);let ee=e=>{var t;let{onOpenChange:l,onLogout:i}=e,n=(0,G.usePathname)(),r=(0,G.useRouter)(),s=(0,j.useTranslations)(),a=(0,j.useLocale)(),o=(0,c.useRef)(null),d=(0,c.useRef)(null),[u,h]=(0,c.useState)(["root"]),[m,f]=(0,c.useState)([$.Fi]),[x,g]=(0,c.useState)(null),[p,v]=(0,c.useState)("auto"),w=(0,c.useRef)(null),b=(0,c.useCallback)((e,t)=>{for(let r of e){var l,i,n;if((null!=(n=null!=(l=r.$title)?l:r.title)?n:"item-".concat(null!=(i=r.href)?i:Math.random()))===t)return r;if(r.children){let e=b(r.children,t);if(e)return e}}return null},[]),N=(0,c.useCallback)(e=>{var t,l,i,n;if(!e.children)return;let r=null!=(i=null!=(t=e.$title)?t:e.title)?i:"item-".concat(null!=(l=e.href)?l:Math.random()),a=e.$title?s(e.$title):null!=(n=e.title)?n:null;h(e=>[...e,r]),f(t=>[...t,e.children]),g(a)},[s]),y=(0,c.useCallback)(()=>{var e,t,l;h(e=>e.length<=1?e:e.slice(0,-1)),f(e=>e.length<=1?e:e.slice(0,-1));let i=u.slice(0,-1);g(i.length<=1?null:(null==(e=b($.Fi,i[i.length-1]))?void 0:e.$title)?s(b($.Fi,i[i.length-1]).$title):null!=(l=null==(t=b($.Fi,i[i.length-1]))?void 0:t.title)?l:null)},[b,s]),k=(0,c.useCallback)(()=>{setTimeout(()=>{h(["root"]),f([$.Fi]),g(null)},300)},[]);(0,c.useEffect)(()=>{requestAnimationFrame(()=>{var e,t;let l=u.length>1?w.current:null==(t=d.current)||null==(e=t.children[0])?void 0:e.querySelector("ul");l?v(Math.max(214,40*(u.length>1)+l.scrollHeight+16)):v("auto")})},[m,u.length]);let A=null!=(t=m[m.length-1])?t:[],C=m.length>1?m[m.length-2]:$.Fi,S=(0,c.useCallback)((e,t,i)=>{let n=e===t?(0,Z.VT)("/".concat(i)):(0,Z.VT)("/".concat(e).concat(i));document.cookie="NEXT_LOCALE=".concat(e,"; path=/; max-age=").concat(31536e3),r.replace(n),null==l||l(!1)},[r,l]),_=(0,c.useCallback)(()=>{null==i||i(),null==l||l(!1)},[i,l]);return{locale:a,pathname:(0,Z.lN)(n).pathname,contentRef:o,menuContainerRef:d,viewStack:u,historyStack:m,currentTitle:x,menuHeight:p,currentPanelRef:w,findItemById:b,navigateToSubmenu:N,navigateBack:y,handleCloseMenu:k,currentItems:A,parentItems:C,handleLanguageChange:S,handleLogout:_,t:s,router:r}},et="text-xs hover:bg-[#424751]/50 hover:text-white px-3 py-2 rounded-md cursor-pointer flex items-center gap-2 w-full";function el(e){let{trigger:t,onLogout:l,isOpen:n,onOpenChange:r,onClickOutside:s}=e,{login:a}=(0,d.J)(),{locale:u,pathname:h,menuContainerRef:m,viewStack:f,currentTitle:x,menuHeight:g,currentPanelRef:v,navigateToSubmenu:w,navigateBack:b,handleCloseMenu:j,currentItems:N,parentItems:k,handleLanguageChange:A,handleLogout:C,t:S}=ee({onOpenChange:r,onLogout:l}),_=(0,c.useRef)(null),E=(0,d.J)();return((0,c.useEffect)(()=>{if(!n)return;let e=e=>{let t=document.getElementById("more-nav-trigger");null!=t&&t.contains(e.target)||_.current&&!_.current.contains(e.target)&&(null==r||r(!1),j(),null==s||s())};return document.addEventListener("mousedown",e,!0),document.addEventListener("touchstart",e,!0),()=>{document.removeEventListener("mousedown",e,!0),document.removeEventListener("touchstart",e,!0)}},[n,r,j]),n)?(0,i.jsxs)("div",{className:"relative z-[999]",children:[t,(0,i.jsxs)("div",{ref:_,className:(0,p.cn)("absolute bottom-full left-0 bg-h5-input rounded-xl w-48 text-gray-400 overflow-hidden","transform transition-opacity duration-300 ease-in-out",n?"opacity-100":"opacity-0 pointer-events-none"),style:{height:"number"==typeof g?"".concat(g,"px"):g,transition:"height 0.3s ease-in-out, opacity 0.3s ease-in-out",marginBottom:"10px"},children:[(0,i.jsxs)("div",{className:(0,p.cn)("flex items-center border-b border-white/10 bg-h5-input px-2 flex-shrink-0 h-10",f.length<=1&&"hidden"),children:[(0,i.jsx)(K.$,{variant:"ghost",size:"sm",className:"h-auto p-1 text-gray-400 hover:text-white hover:bg-transparent -ml-1 mr-1",onClick:b,"aria-label":"返回上一级",children:(0,i.jsx)(Q.A,{className:"h-4 w-4"})}),(0,i.jsx)("span",{className:"text-xs font-medium text-white truncate",children:x})]}),(0,i.jsxs)("div",{ref:m,className:(0,p.cn)("flex w-[200%] h-full","transition-transform duration-300 ease-in-out"),style:{transform:f.length>1?"translateX(-50%)":"translateX(0)"},children:[(0,i.jsxs)("div",{className:"w-1/2 h-full overflow-y-auto scrollbar-hide p-1 flex flex-col pb-0",children:[(0,i.jsx)("ul",{className:"space-y-0.5",children:k.map(e=>{var t,l,n,s,c;if(e.onlyLogin&&!a)return null;let d=!!e.children&&e.children.length>0,u=e.$title?S(e.$title):null!=(t=e.title)?t:"",h=null!=(s=null!=(n=null!=(l=e.$title)?l:e.title)?n:e.href)?s:Math.random();return d?(0,i.jsx)("li",{children:(0,i.jsxs)("button",{type:"button",onClick:t=>{t.preventDefault(),w(e)},className:(0,p.cn)(et,"justify-between"),children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 overflow-hidden",children:[e.icon&&(0,i.jsx)(e.icon,{className:"w-4 h-4 flex-shrink-0"}),(0,i.jsx)("span",{className:"truncate",children:u})]}),(0,i.jsx)(Y.A,{className:"h-4 w-4 text-gray-500 flex-shrink-0"})]})},"".concat(h,"-parent-sub")):(0,i.jsx)("li",{children:(0,i.jsxs)(o(),{href:null!=(c=e.href)?c:"#",prefetch:!1,target:e.openNewTag?"_blank":"_self",className:(0,p.cn)(et),onClick:()=>null==r?void 0:r(!1),children:[e.icon&&(0,i.jsx)(e.icon,{className:"w-4 h-4 flex-shrink-0"}),(0,i.jsx)("span",{className:"truncate",children:u})]})},"".concat(h,"-parent-link"))})}),(0,i.jsxs)("div",{className:"pb-1 flex-shrink-0",children:[(0,i.jsx)("div",{className:"h-[1px] bg-white/20 mx-[-8px] my-1"}),(0,i.jsx)("button",{type:"button",onClick:E.login?C:E.openLogin,className:"flex justify-center gap-2 text-white/50 text-xs hover:bg-[#424751]/50 px-3 py-1.5 rounded-md cursor-pointer w-full",children:(0,i.jsx)("div",{className:"flex items-center gap-2",children:E.login?S("leftNavigation.logout"):S("leftNavigation.login")})})]})]}),(0,i.jsx)("div",{className:"w-1/2 p-1",children:(0,i.jsx)("ul",{className:"space-y-0.5",ref:v,children:N.map(e=>{var t,l,n,s,c,d;if(e.onlyLogin&&!a)return null;let m=e.$title?S(e.$title):null!=(t=e.title)?t:"",f=null!=(c=null!=(s=null!=(n=null!=(l=e.$title)?l:e.title)?n:e.href)?s:e.locale)?c:Math.random(),x="en"===e.locale&&!u||e.locale===u;return(0,i.jsx)("li",{children:(0,i.jsxs)(o(),{href:e.locale?"en"===e.locale?(0,Z.VT)("/".concat(h)):(0,Z.VT)("/".concat(e.locale).concat(h)):null!=(d=e.href)?d:"#",prefetch:!1,target:e.openNewTag?"_blank":"_self",className:(0,p.cn)(et,"justify-between"),onClick:t=>{e.locale?(t.preventDefault(),A(e.locale,"en",h)):null==r||r(!1)},children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 overflow-hidden",children:[e.icon&&(0,i.jsx)(e.icon,{className:"w-4 h-4 flex-shrink-0"}),(0,i.jsx)("span",{className:"truncate",children:m})]}),x&&(0,i.jsx)(y.A.IconCheckCircle,{className:"w-4 h-4 text-primary flex-shrink-0 text-white"})]})},"".concat(f,"-child"))})})})]}),(0,i.jsx)("div",{className:"hidden",children:k.filter(e=>"leftNavigation.overview"===e.$title).map(e=>{var t,l;return e.children?(0,i.jsx)("div",{children:e.children.map(e=>{var t,l,n,r,s,c;if(e.onlyLogin&&!a)return null;let d=e.$title?S(e.$title):null!=(t=e.title)?t:"";return(0,i.jsx)(o(),{href:null!=(l=e.href)?l:"#",prefetch:!1,target:e.openNewTag?"_blank":"_self",className:"sr-only",children:d},"prerender-link-".concat(null!=(c=null!=(s=null!=(r=null!=(n=e.$title)?n:e.title)?r:e.href)?s:e.locale)?c:Math.random()))})},"prerender-".concat(null!=(l=null!=(t=e.$title)?t:e.title)?l:Math.random())):null})})]})]}):t}var ei=l(2240),en=l(19590);let er=e=>{let{id:t,title:l,href:n,avatarUrl:r}=e,a=(0,G.usePathname)(),d=()=>t===a.split("/").pop(),u=(0,c.useRef)(null),h=X(u),m=d()||h;return(0,i.jsx)(o(),{href:n,prefetch:!1,children:(0,i.jsxs)("div",{ref:u,className:"flex items-center gap-2 px-1 rounded-md cursor-pointer relative mb-1",children:[(0,i.jsx)(V.N,{children:m&&(0,i.jsx)(O.U,{initial:{scaleX:0},animate:{scaleX:1},exit:{scaleX:0},transition:{duration:.2},style:{originX:0,position:"absolute",inset:0,zIndex:0},children:(0,i.jsx)(s.default,{src:H,alt:"nav-active-background",width:180,height:40,className:"absolute inset-0 object-cover"})})}),(0,i.jsx)("div",{className:"flex-shrink-0 z-10 p-0.5",children:(0,i.jsx)("div",{className:(0,p.cn)("rounded-full w-8 h-8 p-[1px]",(h||d())&&"bg-h5-block-gradient"),children:(0,i.jsx)("div",{className:"w-full h-full rounded-full overflow-hidden bg-[#0F1115]",children:(0,i.jsx)(s.default,{src:r,alt:"avatar",width:48,height:48,className:"w-full h-full rounded-full bg-slate-500 object-cover object-top"})})})}),(0,i.jsx)("div",{className:"flex-grow max-w-[90%] overflow-hidden z-10",children:(0,i.jsx)("div",{className:"font-medium truncate",children:(0,i.jsx)("span",{className:(0,p.cn)("text-sm leading-4 select-none",m?"text-gradient bg-h5-block-gradient bg-clip-text":"text-[#E0F2FF99]"),children:l})})})]})})},es=e=>{let{className:t,isMobile:l,onDataLoad:n}=e,r=(0,j.useTranslations)(),[s,a]=(0,c.useState)(!1);return(0,i.jsxs)("div",{className:(0,p.cn)("flex flex-col gap-2 h-full",t),children:[s&&(0,i.jsx)("div",{className:"sticky top-0 mb-1",children:(0,i.jsx)("h3",{className:"text-sm text-[#ffffff]/50",children:r("global.recentChats")})}),(0,i.jsx)("div",{className:"h-full overflow-y-auto scrollbar-hide pr-4",children:(0,i.jsx)(ei.d,{queryKey:["recent-chat-list"],queryEnabled:!0,nothingSize:80,queryFn:async e=>{let{pageParam:t=0}=e,i=await (0,en.t1)({page:t,page_size:l?10:14});if(0===t){let e=i.data&&i.data.length>0;a(e),null==n||n(e)}return i},renderList:e=>0===e.length?null:(0,i.jsx)("div",{className:"flex flex-col gap-1 w-full",children:e.map(e=>(0,i.jsx)(er,{title:e.name,id:e._id,href:"/chat/".concat(e._id),avatarUrl:(0,g.jm)(e._id,"moment",e.image_version)},e._id))})})})]})},ea=e=>{var t;let{navTop:l,isMobile:n}=e,r=(0,f.l)(),a=(0,j.useTranslations)("leftNavigation"),u=(0,j.useTranslations)("login"),h=(0,d.J)(),{unreadCount:m}=(0,D.U)(),[x,g]=(0,c.useState)(!1),[v,w]=(0,c.useState)(!1),b=e=>"/"===e?r===e:r.split("/")[1]===e.split("/")[1];return(0,i.jsxs)("div",{className:"relative h-[100dvh] w-[var(--left-nav-width)] bg-[#1C1D1E] text-white z-999 flex flex-col",children:[l,(0,i.jsxs)("div",{className:"h-[calc(100%-118px)] flex flex-col",children:[(0,i.jsxs)("div",{className:"mx-4 flex-shrink-0",children:[h.login&&n&&(0,i.jsx)("div",{className:"mb-4 w-full",children:(0,i.jsx)(U,{userId:(null==(t=h.detail)?void 0:t._id)||""})}),(0,i.jsx)("div",{className:"max-md:mb-2.5 w-full",children:(0,i.jsx)(o(),{href:"/create",prefetch:!1,children:b("/create")?(0,i.jsx)(I.Ay,{wrapperClassName:"rounded-xl",children:(0,i.jsxs)("div",{className:"w-[178px] h-[36px] bg-[#494e5a] rounded-xl flex items-center justify-center relative overflow-hidden",children:[(0,i.jsx)("div",{className:"absolute inset-0 bg-h5-block-gradient opacity-20 z-0"}),(0,i.jsx)("div",{className:"absolute w-[178px] h-[36px] inset-0 overflow-hidden z-0 opacity-50",children:(0,i.jsx)(s.default,{src:T.default,alt:"create",width:178,height:36})}),(0,i.jsxs)("span",{className:"flex items-center space-x-2 relative z-[1]",children:[(0,i.jsx)("div",{className:"isolate",children:(0,i.jsx)(s.default,{src:L,alt:"create",width:24,height:24})}),(0,i.jsx)("span",{className:"text-sm text-transparent bg-clip-text bg-h5-block-gradient",children:a("create")})]})]})}):(0,i.jsx)("div",{className:(0,p.cn)("w-full h-[38px] bg-[#424751]/30 border border-[#424751] hover:bg-[#424751]/50 rounded-xl flex items-center justify-center","transition-colors duration-200"),children:(0,i.jsxs)("span",{className:"flex items-center space-x-2",children:[(0,i.jsx)(R,{className:"w-6 h-6"}),(0,i.jsx)("span",{className:"text-sm text-white",children:a("create")})]})})})}),(0,i.jsxs)("nav",{className:"flex flex-col gap-1.5 md:gap-2 mt-4",children:[$.Oy.map(e=>(0,i.jsx)(J,{title:a(e.$title),href:e.href,icon:e.icon,activeIcon:e.activeIcon,active:b(e.href),badge:e.href===$.Jb.message&&m.total>0?(0,i.jsx)("div",{className:"bg-red-500 rounded-full size-[6px]"}):null},e.href)),h.login?(0,i.jsx)(q,{id:"mine",href:"/mine",avatarUrl:h.avatarUrl||"",className:" py-auto h-[40px]"}):(0,i.jsx)("div",{className:"w-full h-[40px] bg-h5-block-gradient rounded-xl flex items-center justify-center cursor-pointer",onClick:h.openLogin,children:(0,i.jsx)("span",{className:"text-sm text-white",children:u("login")})})]})]}),h.login&&(0,i.jsx)("div",{className:(0,p.cn)("flex-1 mx-4 mt-3 overflow-y-auto scrollbar-hide pt-4 pb-1.5",v&&"border-t border-b border-[#ffffff]/20"),children:(0,i.jsx)(es,{isMobile:n,className:"w-full",onDataLoad:w})})]}),(0,i.jsx)("div",{className:"mt-auto flex-shrink-0 pb-3 px-4",children:(0,i.jsx)("div",{className:"relative",children:(0,i.jsx)(el,{isOpen:x,onOpenChange:n?void 0:g,onClickOutside:()=>g(!1),trigger:(0,i.jsxs)("button",{onClick:()=>g(!x),id:"more-nav-trigger",type:"button",className:"flex items-center text-sm gap-2 text-[rgba(224,242,255,.6)] hover:text-white outline-none px-2 py-2",children:[(0,i.jsx)(y.A.IconMenu,{className:"text-lg"}),(0,i.jsx)("span",{children:x?a("close"):a("more")})]}),onLogout:h.login?h.logout:void 0})})})]})};function eo(e){return e.startsWith("/chat")||e.startsWith("/character/chara_")}let ec=e=>{let{isMobile:t}=e,l=(0,f.l)(),a=(0,d.J)(),w=!eo(l);(0,r.RH)([[v.w,!t&&w]]);let b=(0,c.useRef)(null),[j,N]=(0,n.fp)(v.w),[y,k]=(0,c.useState)(!t&&w),A=(0,c.useCallback)(e=>{let t=window.innerWidth>=1024&&!eo(e);k(t),t||N(!1)},[N]);return(0,u.U)(g.EA.LG,{onMatch:()=>A(l)}),(0,c.useEffect)(()=>{A(l)},[l,A]),!function(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mousedown",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];!function(e,t,l,i){let n=(0,c.useRef)(t);(0,m.E)(()=>{n.current=t},[t]),(0,c.useEffect)(()=>{var t;let r=null!=(t=null==l?void 0:l.current)?t:window;if(!(null==r?void 0:r.addEventListener))return;let s=e=>{n.current(e)};return r.addEventListener(e,s,i),()=>{r.removeEventListener(e,s,i)}},[e,l,i])}(l,l=>{let i=l.target;!(!i||!i.isConnected||n.some(e=>{let t=e();return null==t?void 0:t.contains(i)}))&&((0,h.c)(e)?e.filter(e=>!!e.current).every(e=>e.current&&!e.current.contains(i)):e.current&&!e.current.contains(i))&&t(l)},void 0,i)}(b,()=>{y||N(!1)}),(0,i.jsxs)(i.Fragment,{children:[t&&(0,i.jsx)("div",{className:(0,p.cn)("absolute inset-0 bg-[#1C1D1E] bg-opacity-50 z-[1] lg:hidden",y||j?"":"hidden"),onClick:()=>N(!1),onKeyDown:e=>{"Escape"===e.key&&N(!1)}}),(0,i.jsx)("div",{ref:b,className:(0,p.cn)("fixed top-0 left-0 h-full z-[22] transition-transform duration-300 transform",y||j?"translate-x-0":"-translate-x-full"),children:(0,i.jsx)("div",{className:"relative z-10 w-[212px] h-full bg-[#0F1115] ",children:(0,i.jsx)(ea,{isMobile:t,navTop:(0,i.jsxs)("div",{className:"flex flex-row justify-between px-6 pr-4 w-full py-4 md:py-[18px]",children:[(0,i.jsx)(o(),{href:"/explore",prefetch:!1,className:"cursor-pointer h-8 md:h-10 flex items-center",children:(0,i.jsx)(s.default,{width:74,height:24,className:"object-contain",src:x.A.logo,alt:"Rubii",priority:!0})}),a.login&&(0,i.jsx)(E,{})]})})})})]})},ed=ec}}]);