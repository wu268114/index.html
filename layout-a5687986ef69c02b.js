(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1969],{15692:(e,r,n)=>{"use strict";var t,o;n.d(r,{q:()=>i});let i=(0,n(72197).eU)({login:!!(null==(o=n.g)||null==(t=o.localStorage)?void 0:t.getItem("accessToken")),refresh:async()=>{}})},38620:(e,r,n)=>{"use strict";function t(e){let{src:r,width:n,quality:t=75}=e;return"https://cdn.rubii.ai/cdn-cgi/image/".concat(["width=".concat(n),"quality=".concat(t||75),"format=auto"].join(","),"/").concat(r)}function o(e,r,n){return"https://cdn.rubii.ai/cdn-cgi/image/width=".concat(r,",blur=").concat(n,",format=auto/").concat(e)}function i(e){return r=>{let{src:n,width:t,quality:o}=r,i=["width=".concat(t),"quality=".concat(o||75),"format=auto"];return!1===e&&i.push("anim=false"),"https://cdn.rubii.ai/cdn-cgi/image/".concat(i.join(","),"/").concat(n)}}n.r(r),n.d(r,{LoaderWithAnimation:()=>i,default:()=>t,getBlurDataURL:()=>o})},41887:(e,r,n)=>{"use strict";n.d(r,{$:()=>u,r:()=>s});var t=n(53400),o=n(10526),i=n(88466),l=n(48276),a=n(92380);let s=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground",destructive:"bg-destructive text-destructive-foreground",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",xs:"h-8 rounded-lg px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=l.forwardRef((e,r)=>{let{className:n,variant:i,size:l,asChild:u=!1,...d}=e,c=u?o.DX:"button";return(0,t.jsx)(c,{className:(0,a.cn)(s({variant:i,size:l,className:n})),ref:r,...d})});u.displayName="Button"},61281:(e,r,n)=>{"use strict";n.d(r,{J:()=>m});var t=n(3666),o=n(90885),i=n(1233),l=n(48276),a=n(15692),s=n(41401),u=n(19590),d=n(79896),c=n(10190);let m=()=>{let[e,r]=(0,i.fp)(a.q),n=(0,c.A)(e=>e.userData),m=(0,c.A)(e=>e.setUserData),v=(0,c.A)(e=>e.setShowLogin),h=(0,t.useMutation)({mutationFn:u.Mi,onSuccess:e=>{e&&n&&m({...n,token:e})}}),{remainingDays:f,maxDate:g}=(0,l.useMemo)(()=>{var r,t,o;return e.login&&n?(0,d.MU)({plus_expires_at:null!=(r=null==n?void 0:n.plus_expires_at)?r:"",pro_expires_at:null!=(t=null==n?void 0:n.pro_expires_at)?t:"",premium_expires_at:null!=(o=null==n?void 0:n.premium_expires_at)?o:""}):{remainingDays:0,maxDate:null}},[n,e.login]),p=(0,l.useMemo)(()=>e.login&&(null==n?void 0:n._id)?(0,s.jm)("".concat(null==n?void 0:n._id,"_avatar"),"user",null==n?void 0:n.image_version):"",[e.login,n]),{data:x,refetch:b}=(0,o.useQuery)({queryKey:["freeGenCount"],queryFn:u.TM,enabled:e.login});return{login:e.login,detail:e.login?n:void 0,remainingDays:f,maxDate:g,avatarUrl:p,openLogin:()=>{v(!0)},closeLogin:()=>{v(!1)},refresh:e.refresh,refreshBalance:h.mutateAsync,logout:()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),m(void 0),r(e=>({...e,login:!1}))},freeGenCount:x,refreshFreeGenCount:b}}},63347:(e,r,n)=>{"use strict";n.d(r,{SoundProvider:()=>l});var t=n(53400),o=n(48276),i=n(79717);function l(e){let{children:r}=e,n=(0,o.useRef)(null),[l,a]=(0,o.useState)(!1),[s,u]=(0,o.useState)(null),d=(0,o.useRef)(0),c=async(e,r)=>{let t=++d.current;n.current||(n.current=new Audio,n.current.addEventListener("ended",()=>{a(!1),u(null)}));let o="";o=e instanceof File?URL.createObjectURL(e):e;try{if(l&&(n.current.pause(),n.current.currentTime=0),!o)throw Error("无效的音频URL");s!==(r||o)&&(n.current.src=o,u(r||o)),await new Promise((e,r)=>{let o=n.current;if(!o)return void r(Error("Audio element not found"));let i=()=>{t===d.current&&(o.removeEventListener("canplay",i),o.removeEventListener("error",l),e(null))},l=e=>{var n;let t=e.target;console.error("音频加载错误详情:",{error:t.error,networkState:t.networkState,readyState:t.readyState,src:t.src}),o.removeEventListener("canplay",i),o.removeEventListener("error",l),r(Error("音频加载失败: ".concat((null==(n=t.error)?void 0:n.message)||"未知错误")))};o.addEventListener("canplay",i),o.addEventListener("error",l),o.load()}),t===d.current&&(await n.current.play(),a(!0))}catch(r){throw t===d.current&&(console.error("播放音频失败:",{error:r,audioUrl:o,isFile:e instanceof File,currentAudio:s}),a(!1),u(null)),e instanceof File&&URL.revokeObjectURL(o),r}};return(0,t.jsx)(i.j.Provider,{value:{play:c,pause:()=>{n.current&&(n.current.pause(),a(!1))},stop:()=>{n.current&&(n.current.pause(),n.current.currentTime=0,a(!1),u(null))},isPlaying:l,currentAudio:s},children:r})}},79325:(e,r,n)=>{Promise.resolve().then(n.bind(n,46211)),Promise.resolve().then(n.bind(n,6415)),Promise.resolve().then(n.bind(n,48930)),Promise.resolve().then(n.t.bind(n,98016,23)),Promise.resolve().then(n.t.bind(n,63152,23)),Promise.resolve().then(n.bind(n,43083)),Promise.resolve().then(n.bind(n,41814)),Promise.resolve().then(n.bind(n,5293)),Promise.resolve().then(n.bind(n,63559)),Promise.resolve().then(n.bind(n,78515)),Promise.resolve().then(n.bind(n,85261)),Promise.resolve().then(n.bind(n,69062)),Promise.resolve().then(n.bind(n,30757)),Promise.resolve().then(n.bind(n,93174)),Promise.resolve().then(n.bind(n,46644)),Promise.resolve().then(n.bind(n,78367)),Promise.resolve().then(n.bind(n,98759)),Promise.resolve().then(n.bind(n,96391)),Promise.resolve().then(n.bind(n,63347))},79717:(e,r,n)=>{"use strict";n.d(r,{Y:()=>i,j:()=>o});var t=n(48276);let o=(0,t.createContext)(null);function i(){let e=(0,t.useContext)(o);if(!e)throw Error("useSound必须在SoundProvider中使用");return e}},92380:(e,r,n)=>{"use strict";n.d(r,{cn:()=>i});var t=n(52800),o=n(84069);function i(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return(0,o.QP)((0,t.$)(r))}},96391:(e,r,n)=>{"use strict";n.d(r,{default:()=>s});var t=n(53400),o=n(50122),i=n(49460),l=n(55766),a=n(1233);let s=()=>{let e=(0,i.l)(),r=(0,a.Xr)(l.w);return e.startsWith("/character/chara_")?null:(0,t.jsx)("div",{className:"fixed left-2 top-3 z-[21] lg:hidden",children:(0,t.jsx)("button",{type:"button",className:"text-white text-2xl flex items-center justify-center",onClick:()=>r(!0),children:(0,t.jsx)(o.A.IconNavMenu,{})})})}},98169:(e,r,n)=>{"use strict";n.d(r,{Ay:()=>s});var t=n(53400),o=n(92380),i=n(88466);let l=(0,i.F)("p-[1px] bg-h5-block-gradient",{variants:{rounded:{none:"rounded-none",sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl","2xl":"rounded-2xl","3xl":"rounded-3xl",full:"rounded-full"}},defaultVariants:{rounded:"lg"}}),a=(0,i.F)("w-full h-full",{variants:{rounded:{none:"rounded-none",sm:"rounded-[calc(theme(borderRadius.sm)-1px)]",md:"rounded-[calc(theme(borderRadius.md)-1px)]",lg:"rounded-[calc(theme(borderRadius.lg)-1px)]",xl:"rounded-[calc(theme(borderRadius.xl)-1px)]","2xl":"rounded-[calc(theme(borderRadius.2xl)-1px)]","3xl":"rounded-[calc(theme(borderRadius.3xl)-1px)]",full:"rounded-full"}},defaultVariants:{rounded:"lg"}});function s(e){let{as:r,className:n,wrapperClassName:i,contentProps:s,children:u,rounded:d,...c}=e;return(0,t.jsx)(null!=r?r:"div",{className:(0,o.cn)(l({rounded:d}),i),...c,children:(0,t.jsx)("div",{className:(0,o.cn)(a({rounded:d}),n),...s,children:u})})}}},e=>{var r=r=>e(e.s=r);e.O(0,[1093,2090,2164,6190,8927,3602,9324,5978,1937,4784,1781,9124,2292,9589,9884,1401,9590,6616,1845,8921,9483,7358],()=>r(79325)),_N_E=e.O()}]);